<div class="cart-total">
<h1>Cart page</h1>
<%= link_to 'Empty the Cart', cart_clear_path %>
<br><br><br>

<% total = 0 %>

<table>
  <tr class="cart">
    <td>Name</td>
    <td>Price</td>
    <td>Quantity</td>
    <td>Total price</td>
  </tr>

  <% @cart.each do | id, quantity | %>
    <% product = Product.find_by_id(id) %>
  <tr>
    <td><%= product.name %></td>
    <td><%= number_to_currency(product.price, :unit => "€") %></td>
    <td><%= link_to "-", remove_cart_path(product) %>
    <%= quantity %><%= link_to "+", add_cart_path(product) %> </td>
    <% subtotal = quantity * product.price %>
    <td><%=number_to_currency(subtotal, :unit => "€") %></td>
  </tr>
    <%total = total + subtotal%>
  <% end %>
  </table>
  <br>
  <% if total < 50 %>
  <%= "Shipping charges: €3.50 (items above €50.00 are free of shippingcharges)"%>
  <% total= total + 3.50 %>
  <% else %>
  <%= "No shipping charges"%>
  <% end %>
  <br><br>

  <b>Total shopping cart:<%= number_to_currency(total, :unit => "€") %></b>

  <p><%= link_to "Continue Shopping", categories_path %></p><br>
  </div>

  <% if user_signed_in?%>
    <div class= "checkout"><%= link_to 'Checkout', cart_checkout_path %></div>
  <% else %>
    <%= link_to "Log in to checkout", new_user_session_path %>
  <% end %>
